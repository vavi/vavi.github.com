---
layout: post
title: "深入理解JVM 内存管理"
description: ""
category: 
tags: [深入理解JVM]
---
### 前言
1. 权利越大,责任越大,对能力要求也越高.在C++中,需要程序员自己来控制内存的申请和释放,从而可以获得更高极限的性能;但是主要有两个方面的原因导致需要自动管理内存的语言:1.在大型系统中,很难避免一些内存管理问题发生;内存管理需要更高技能的程序员,不利于短时间内给公司创造价值.
2. 在解决问题前,首先要充分了解问题,尝试将问题分成若干个类别,针对每个类别再去寻找合适的解决方法;在解决问题时,尤其是复杂问题时,我们要学会将复杂问题拆成若干个小问题;

### 数据运行区域
JVM虚拟机在执行java程序的过程中会把其管理的内存划分为若干个不同的数据区域.从这些区域的生命周期来看,有些是**JVM**启动时创建,结束时销毁;有的是**线程**启动时创建,结束时销毁.

* 程序计数器,用来在线程切换后,仍然能够将线程恢复的正确的执行位置.PC的值通常是下一条需要执行的字节码指令.生命周期与线程相同的.
* Java虚拟机栈,即我们通常所说的栈,主要用来存放栈帧.栈帧用于存储局部变量表(基本数据类型,对象引用和returnAddress类型)、操作栈、动态链接、方法出口等.生命周期与线程相同的.
* Java堆,几乎所有的对象实例和数组都是在堆上分配的(栈上分配,标量替换使得对象实例不一定分配在堆上面).生命周期与JVM 进程相同
* 方法区,主要用来存放类信息,常量,静态变量,即时编译后的代码等数据.
* 运行时常量池,该区是方法区的一部分,主要用于存放从编译期可知的数值字面量到必须运行期解析后才能获得的方法或字段引用.
* 本地方法栈,Java虚拟机实现可能会使用到传统的栈（通常称之为“C Stacks”）来支持native方法（指使用Java以外的其他语言编写的方法）的执行，这个栈就是本地方法栈（Native Method Stack）。

`Ojbect obj = new Object();` 这段简单的语句执行时,牵扯到栈,堆和方法区.  HotSpot JVM 中,ojb 这个reference直接存放的就是对象地址,其目的主要是为了提升性能.

 



### 参考
http://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html#jvms-2.5

{% include JB/setup %}
